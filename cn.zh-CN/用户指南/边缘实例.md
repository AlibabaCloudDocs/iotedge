# 边缘实例 {#task_vwg_j54_f2b .task}

边缘实例是一种类似文件夹的管理功能，您可以通过实例的方式管理边缘相关的网关、设备，同时也可以管理规则计算、函数计算和消息路由内容。通过部署实例，将添加在实例中的资源部署至网关中。

1.  创建边缘实例。 
    1.  在[IoT控制台](http://iot.console.aliyun.com/)，选择**边缘计算** \> **边缘实例**。 
    2.  单击**新增实例**。 ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15108/15439309076722_zh-CN.png) 
    3.  设置实例名称，用于后续的查询及识别实例。我们还为您提供了标签能力，通过标签您可以更加有效的去归类及识别实例。 
    4.  关联**网关产品**和**网关设备**，选择已创建的网关产品和网关设备。 
    5.  单击**确认**。 
    6.  在边缘实例页面，选择已创建的实例，单击右侧的**查看**，进入实例详情页面。 
2.  分配网关。 网关页签下，显示已分配的网关产品和网关设备。

    **说明：** 若需要更换网关，则先移除已分配的网关，再根据如下步骤重新分配网关到实例中。

    1.  实例详情页面，选择实例信息，单击网关右侧的**分配网关**。 
    2.  在分配网关页面中，选择需要关联的网关，单击网关右侧的**分配**。 后续部署及重置的指令都将发送至该网关，目前一个实例有且仅有一个网关。
    3.  单击**完成**。 
3.  分配子设备。 
    1.  在实例详情页面，选择子设备，单击**分配子设备**。 
    2.  在分配子设备页面中，将之前创建的设备（只支持高级版产品创建的设备）分配至实例中，单击设备右侧的**分配**。 若无可分配子设备，单击**新建子设备**创建。 ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15108/15439309076726_zh-CN.png) 所有被分配到实例中的设备列表才是最终网关被允许访问的范围。
    3.  单击**完成**，完成设备的分配。 
    4.  单击已分配的子设备右侧的**驱动配置**，为设备分配官方驱动或自定义驱动。 

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15108/154393090710233_zh-CN.png)

        -   子设备的接入网关协议为**自定义**时：

            |参数|描述|
            |--|--|
            |选择驱动|选择已创建的自定义驱动。创建自定义驱动请参考[自定义驱动](cn.zh-CN/用户指南/驱动管理/自定义驱动.md#)。|
            |自定义配置|根据您的驱动，自定义配置内容。若你的自定义驱动文件是根据Link IoT Edge[边缘开发指南](../../../../cn.zh-CN/边缘开发指南/设备接入SDK综合示例.md#)开发，那么此处必须与您开发驱动文件时定义的驱动配置格式一致。|

        -   子设备的接入网关协议为**OPC UA**时：

            |参数|描述|
            |--|--|
            |选择驱动|系统默认选择**OPC UA**官方驱动。|
            |选择通道|选择已创建的OPC UA通道，若无可用通道，在实例详情页面，单击**子设备通信通道**，为实例中的网关和OPC UA设备配置交互方式。配置方法请参考[子设备通道管理](../../../../cn.zh-CN/用户指南/产品与设备/网关与子设备/子设备通道管理.md#)。|
            |节点路径|OPC UA设备在OPC UA Server中的节点展示路径。|

        -   子设备的接入网关协议为**Modbus**时：

            |参数|描述|
            |--|--|
            |选择驱动|系统默认选择**Modbus**官方驱动。|
            |选择通道|选择已创建的Modbus通道，若无可用通道，在实例详情页面，单击**子设备通信通道**，为实例中的网关和Modbus设备配置交互方式。配置方法请参考[子设备通道管理](../../../../cn.zh-CN/用户指南/产品与设备/网关与子设备/子设备通道管理.md#)。|
            |从站号|用来标识Modbus设备在总线上的地址。|

    5.  单击**完成**，您已成功为设备配置了驱动。 配置边缘网关完成后，若网关的Docker版本为v1.8及以上时，可以单击**远程登录控制台**，输入网关设备账号密码，登录网关设备进行设备管理操作。 单击**远程文件管理**，可以查看网关的目录结构并进行管理文件的操作。

        **说明：** 远程登录控制台和远程文件管理，具有高级权限，可进行更新、删除、改动、查看各类网关设备的信息和文件。请谨慎使用。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15108/154393090733585_zh-CN.png)

4.  （可选）分配规则。 
    1.  在实例详情页面，选择规则计算，单击**分配规则**。 
    2.  在分配规则页面中，将之前创建的[规则计算](cn.zh-CN/用户指南/配置边缘计算节点/控制台创建网关.md#)中的规则分配至实例中，单击设备右侧的**分配**。 这些规则将在部署时发送至网关上，并在网关上执行规则定义的逻辑。
    3.  单击**完成**，完成分配规则计算到实例中。 
5.  （可选）分配函数。 
    1.  在实例详情页面，选择函数计算，单击**分配函数**。 
    2.  在分配函数页面中，将之前创建的[函数计算](cn.zh-CN/用户指南/函数计算/边缘计算中的函数计算.md#)中的函数分配至实例中，单击**分配**。 这些规则将在部署时发送至网关上，并在网关本地运行。
6.  （可选）分配任务。 
    1.  在实例详情页面，选择流数据分析，单击**分配任务**。 
    2.  在分配任务页面中，选择已经存在的任务单击**分配**，使用流数据分析功能对您的数据进行分析处理。 若无可选任务，请参考[任务管理](../../../../cn.zh-CN/数据分析服务/流数据分析/任务管理.md#)创建任务。
    3.  单击**完成**，您已成功为实例添加了任务。 
7.  （可选）添加角色。 

    **说明：** 实例中的函数在边缘网关运行时，若要调用阿里云其他云资源（例如调用访问OSS的API），则需要为实例添加角色。操作详情请参考[资源访问授权](cn.zh-CN/用户指南/资源访问授权.md#)。

8.  （可选）添加消息路由。 
    1.  在实例详情页面，选择消息路由，单击**添加路由**。 
    2.  在添加消息路由页面中，配置参数，您可以通过[消息路由](cn.zh-CN/用户指南/消息路由.md#)中查看具体配置方式。 
    3.  单击**确定**，您已成功为实例添加了消息路由。 
9.  部署实例。 
    1.  在实例详情页面，单击**部署实例**，将上述实例中添加的资源部署至网关中。 

        **说明：** 当您实例中的网关处于离线状态时，您的部署请求将被托管，直到网关上线后平台将主动通知网关进行资源部署操作。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15108/15439309076732_zh-CN.png) 

    2.  您可以通过单击**部署详情**，查看部署过程。 如果您对当前实例内的资源做了修改，可以单击**实例部署**再次进行部署。
10. （可选）重置实例。 

    **说明：** 

    -   由于该操作会将网关从工作状态切换为初始状态所以请谨慎操作。
    -   当您实例中的网关处于离线状态时，您的部署请求将被托管，直到网关上线后平台将主动通知网关进行资源重置操作。
    1.  在实例详情页面，单击**重置**，重置已部署至网关中的资源（例如，将下发的规则计算、函数计算、消息路由等资源做清理）。 ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15108/15439309076733_zh-CN.png) 
    2.  您可以单击**部署详情**，查看重置进展。 

