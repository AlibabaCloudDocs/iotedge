# 已购驱动

Link IoT Edge支持从物联网市场购买驱动并使用到边缘设备中。

已根据[环境搭建](/cn.zh-CN/用户指南/环境搭建/专业版环境搭建/基于Ubuntu 16.04搭建环境.md)内容，创建边缘实例并上线网关。

## 操作步骤

1.  在[边缘计算控制台](https://iot.console.aliyun.com/le/instance/list)的**驱动管理**页面，选择**已购驱动**。

2.  单击**选购驱动**。

    ![选购驱动](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0548420061/p60809.png)

3.  在[阿里云物联网市场](https://linkmarket.aliyun.com/)的边缘驱动市场中，选购适配于边缘计算的驱动程序。

    驱动市场中选购驱动的操作请参见[驱动市场](/cn.zh-CN/用户指南/生态合作/驱动市场.md)。

4.  驱动选购成功后显示在[边缘计算控制台](https://iot.console.aliyun.com/le/instance/list)**驱动管理**页面已购驱动页签的已购驱动列表区域框中。

    ![已购驱动列表](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0548420061/p60812.png)

    已购驱动操作说明如下。

    |操作|说明|
    |--|--|
    |查看|单击已购驱动后的**查看**，可在[物联网市场](https://linkmarket.aliyun.com/)用户中心查看驱动的详细信息。|
    |再次购买|在驱动有效期到期之前可再次购买驱动，购买操作请参见[驱动市场](/cn.zh-CN/用户指南/生态合作/驱动市场.md)。|

5.  驱动购买成功后，将驱动分配到边缘实例中。

    1.  在**边缘实例**页面，选择已创建的边缘实例，单击右侧的**查看**。

    2.  在**实例详情**页面，选择设备驱动配置，单击**全部驱动**右侧的`+`图标。

    3.  在分配驱动对话框中选择**已购驱动**，单击对应驱动名称后的**分配**。

        ![分配已购驱动](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0548420061/p60820.png)

    4.  （可选）选择已购驱动单击设备列表右侧的**驱动配置**，可对当前驱动进行配置。配置完成后单击**确定**。

        |参数|描述|
        |--|--|
        |配置格式|配置格式有如下三种：         -   键值对配置
        -   JSON格式
        -   配置文件 |
        |配置格式为键值对配置时|单击**新增配置**，通过设置配置名称、值、注释来配置驱动。 最多添加100个键值对。 |
        |配置格式为JSON格式时|编写JSON格式配置内容，内容不超过1 KB。编写内容时，系统自动校验格式。若格式错误，可根据系统提示编写正确格式的内容。|
        |配置格式为配置文件时|需要在本地编写配置文件，并上传。|

    5.  （可选）在设备列表右侧，单击**容器配置**，对当前驱动进行容器配置。配置完成后单击**保存**。

        **说明：** 仅在产品规格为专业版的边缘实例中，允许设置**容器配置**。

        |参数|描述|
        |--|--|
        |是否使用宿主机host模式|选择是否隔离容器的网络。直接使用宿主机网络环境。         -   是：表示不隔离容器的网络，直接使用宿主机网络环境。
        -   否：表示隔离容器的网络，需要设置网络端口映射。 |
        |网络端口映射|当是否使用宿主机host模式为否时出现的参数。函数的网络环境和宿主机的环境是完全隔离的。通过网络端口映射，将容器内函数的监听端口映射到宿主机的某一个端口上，实现不同主机上的客户端程序，能够访问该函数提供的服务。最多支持映射10条网络端口。 例如，运行在宿主机容器内的`fc-http-server`函数，通过80端口对外界提供服务。此时，其它主机上的客户端程序，无法通过访问宿主机的80端口，访问到`fc-http-server`函数。因此需要将`fc-http-server`函数所在的容器端口映射到宿主机的某一个端口上（例如将容器内的80端口映射到宿主机8080端口），允许其它主机上的客户端程序通过访问`宿主机的IP地址：8080`，访问到容器内部的`fc-http-server`函数。 |
        |是否启动特权模式|容器内的root用户实际上只是宿主机的一个普通用户。若在容器内部做修改系统时间、使用mount命令等需要root权限的操作，则需要赋予容器privileged特权。

**说明：** 特权模式下，容器内部拥有宿主机的root权限，而且宿主机的所有设备会默认映射到容器内部，即无需配置设备映射。 |
        |设备映射|当是否启动特权模式为否时出现的参数。设备管理系统和宿主机的环境是完全隔离的。当一个函数需要访问宿主机的设备（例如串口）时，需要将设备映射到运行函数的容器内部。最多可添加10个设备映射。|
        |卷映射|文件系统和宿主机的环境是完全隔离的。当一个函数需要访问宿主机的文件时，需要将文件映射到运行函数的容器内部。最多可添加10个卷映射。|
        |内存限制|设置容器的内存上限。 当容器内存使用超过限制时，容器会被重启。如果内存限制值过小，可能会导致容器内的应用运行失败。默认内存为1024 MB，请根据容器内应用大小，上调内存限制。|

    6.  单击**分配子设备**，在已购驱动下，为边缘实例分配子设备。

        ![已购驱动分配子设备](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0548420061/p60824.png)

    7.  （可选）分配设备到边缘实例后，单击设备名称对应操作栏中的**设备配置**，可对当前设备进行配置，例如配置设备序列号，方便驱动处理指定序列号设备的相关信息。

        编写JSON格式配置内容（内容不可超过1 KB），并**校验格式**通过后，单击**确定**，完成配置。

6.  部署边缘实例。

    1.  在**实例详情**页面，单击右上角**部署**后在弹出对话框中单击**确定**，部署边缘实例。

    2.  当部署状态显示为**部署成功**，表示部署实例完成。您可以单击**查看日志**，查看部署详情。


